"use strict";function upload(e){var t=new FormData;t.append("file",e.files[0]),t.append("_token",csrfToken),$("#loading").css("display","block"),$.ajax({url:imageUploadUrl,data:t,type:"POST",contentType:!1,processData:!1,cache:!1,success:function(e){e.fail?($("#profileImage").attr("src",profileImagePath),$("#file-error").show().addClass("error").html(e.errors.file).css({color:"red !important","font-size":"14px","font-weight":"800","padding-top":"5px"})):($("#file-error").hide(),$("#file_name").val(e),$("#profileImage").attr("src",uploadImagePath+"/"+e),$("#profileImageHeader").attr("src",uploadImagePath+"/"+e)),$("#loading").css("display","none")},error:function(e,t,n){alert(e.responseText),$("#profileImage").attr("src",profileImagePath)}})}function getDepositFeesLimit(){var e=csrfToken,t=$("#amount").val(),n=$("#currencies").val(),a=$("#user").val();$.ajax({method:"POST",url:feesLimitCheckUrl,dataType:"json",data:{token:e,amount:t,currency_id:n,transaction_type_id:transactionType,user_id:a}}).done(function(e){if(200==e.success.status)$("#percentage_fee").val(e.success.feesPercentage),$("#fixed_fee").val(e.success.feesFixed),$("#agent_p_fee").val(e.success.agentFee),$("#total_fees").val(e.success.totalFees),$("#total_amount").val(e.success.totalAmount),$(".fee").val(e.success.totalFees),$(".total_fees").html(e.success.totalFeesHtml),$(".pFees").html(e.success.pFeesHtml),$(".aFees").html(e.success.aFeesHtml),$(".fFees").html(e.success.fFeesHtml),$("#payment_method").val(e.success.payment_method),$(".amountLimit").text(""),402==e.success.code?($("#feesLimitError").html(e.success.mgs),$("#send_money").attr("disabled",!0),$(".spinner").show()):e.success.totalAmount-e.success.agentFee>=e.success.agentbalance?($(".amountLimit").html(errorTxt),$("#send_money").attr("disabled",!0)):($(".amountLimit").html(""),$("#send_money").removeAttr("disabled"));else{if(""!=t)return $(".amountLimit").text(e.success.message),$("#send_money").attr("disabled",!0),!1;$(".amountLimit").text(""),$("#send_money").attr("disabled",!1)}})}function depositPaymentBack(){window.history.back()}function disable_f5(e){116==(e.which||e.keyCode)&&e.preventDefault()}function disable_ctrl_r(e){82==e.keyCode&&e.ctrlKey&&e.preventDefault()}function confirmPwd(){pwd1.value!=pwd2.value?pwd2.setCustomValidity("Passwords Don't Match"):pwd2.setCustomValidity("")}function formattedPhone(){var e;""!=$("#phone").val&&(e=$("#phone").intlTelInput("getNumber").replace(/-|\s/g,""),$("#formattedPhone").val(e))}function enableDisableButton(){hasPhoneError||hasEmailError?$("form").find("button[type='submit']").prop("disabled",!0):$("form").find("button[type='submit']").prop("disabled",!1)}var hasPhoneError,hasEmailError,pwd1,pwd2,countryData,isNumberOrDecimalPointKey;function confirmPwd(){pwd1.value!=pwd2.value?pwd2.setCustomValidity("Passwords Don't Match"):pwd2.setCustomValidity("")}function enableDisableButton(){hasPhoneError||hasEmailError?$("form").find("button[type='submit']").prop("disabled",!0):$("form").find("button[type='submit']").prop("disabled",!1)}function formattedPhone(){var e;""!=$("#phone").val&&(e=$("#phone").intlTelInput("getNumber").replace(/-|\s/g,""),$("#formattedPhone").val(e))}function checkInvalidAndDuplicatePhoneNumberForUserProfile(e,t,n){var a=$("input[name=phone]");""!==$.trim(a.val())?a.intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim(a.val()))?($("#tel-error").html(""),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:ajaxUrlPhoneCheck,dataType:"json",cache:!1,data:{phone:e,carrierCode:t,id:n}}).done(function(e){1==e.status?($("#tel-error").html(""),$("#phone-error").show(),$("#phone-error").addClass("error").html(e.fail).css("font-weight","bold"),hasPhoneError=!0,enableDisableButton()):0==e.status&&($("#tel-error").show(),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())})):($("#tel-error").addClass("error").html("Please enter a valid International Phone Number.").css("font-weight","bold"),hasPhoneError=!0,enableDisableButton(),$("#phone-error").hide()):($("#tel-error").html(""),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())}function getPayoutFeesLimit(){var e=csrfToken,t=$("#amount").val(),n=$("#currencies").val(),a=$("#user").val();$.ajax({method:"POST",url:feesLimitCheckUrl,dataType:"json",data:{token:e,amount:t,currency_id:n,transaction_type_id:transactionType,user_id:a}}).done(function(e){if(200==e.success.status)$("#percentage_fee").val(e.success.feesPercentage),$("#fixed_fee").val(e.success.feesFixed),$("#agent_p_fee").val(e.success.agentFee),$("#total_fees").val(e.success.totalFees),$("#total_amount").val(e.success.totalAmount),$(".fee").val(e.success.totalFees),$(".total_fees").html(e.success.totalFeesHtml),$(".pFees").html(e.success.pFeesHtml),$(".aFees").html(e.success.aFeesHtml),$(".fFees").html(e.success.fFeesHtml),$("#payment_method").val(e.success.payment_method),$(".amountLimit").text(""),401==e.success.code?($("#withdrawMoney").attr("disabled",!0),$(".spinner").show()):e.success.totalAmount>e.success.balance?($("#amountLimit").html(errorTxt),$("#withdrawMoney").attr("disabled",!0)):($("#amountLimit").html(""),$("#withdrawMoney").removeAttr("disabled"));else{if(""!=t)return $(".amountLimit").text(e.success.message),$("#withdrawMoney").attr("disabled",!0),!1;$(".amountLimit").text(""),$("#withdrawMoney").attr("disabled",!1)}})}function payoutPaymentBack(){window.history.back()}function payoutVerification(){var e=$("#payout_verify_code").val(),t=csrfToken,n=$("#user_id").val();$.ajax({method:"POST",url:verifyCodeCheckUrl,dataType:"json",data:{token:t,user_id:n,verification_code:e}}).done(function(e){200==e.success.status?($("#withdrawMoneyConfirm").attr("disabled",!1),$("#verification_message").text(" ")):($("#withdrawMoneyConfirm").attr("disabled",!0),$("#verification_message").text(errorTxt))})}function startTimer(e,t){var n,a,o=e;setInterval(function(){n=parseInt(o/60,10),a=parseInt(o%60,10),n=n<10?"0"+n:n,a=a<10?"0"+a:a,t.text(n+":"+a),--o<0&&(o=e)},1e3)}function disable_f5(e){116==(e.which||e.keyCode)&&e.preventDefault()}function disable_ctrl_r(e){82==e.keyCode&&e.ctrlKey&&e.preventDefault()}$(".main-content").find("#profile").length&&$("#file").change(function(){""!=$(this).val()&&upload(this)}),$(".main-content").find("#deposit").length&&($(window).on("load",function(){$("#amount").val("")}),$("#amount").on("input",function(e){""==$(this).val()||isNaN($(this).val())||getDepositFeesLimit()}),$("#currencies").on("change",function(e){getDepositFeesLimit()}),$("#user").select2({placeholder:"Search User",minimumInputLength:1,ajax:{method:"POST",url:SITE_URL+"/agent/search-user",delay:500,processResults:function(e){return{results:e}}}})),$(".main-content").find("#depositConfirm").length&&$("#cashPayment").validate({submitHandler:function(e){$("#send_money").attr("disabled",!0),$(".spinner").show();var t=$("#send_text").text();$("#send_text").text("Processing..."),e.submit(),setTimeout(function(){$("#send_money").removeAttr("disabled"),$(".spinner").hide(),$("#send_text").text(t)},1e4)}}),$(".main-content").find("#depositSuccess").length&&($(document).ready(function(){window.history.pushState(null,"",window.location.href),window.onpopstate=function(){window.history.pushState(null,"",window.location.href)}}),$(document).ready(function(){$(document).bind("keydown",disable_f5)}),$(document).ready(function(){$(document).bind("keydown",disable_ctrl_r)})),$(".agent-login-bg").find("#forget").length&&($.validator.setDefaults({highlight:function(e){$(e).parent("div").addClass("has-error")},unhighlight:function(e){$(e).parent("div").removeClass("has-error")}}),$("#forget-password-form").validate({errorClass:"has-error",rules:{email:{required:!0,email:!0}},submitHandler:function(e){$("#agent-forget-password-submit-btn").attr("disabled",!0).click(function(e){e.preventDefault()}),$(".fa-spin").show(),$("#agent-forget-password-submit-btn-text").text("Submitting.."),e.submit()}})),$(".agent-login-bg").find("#login").length&&$(function(){$("input").iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue",increaseArea:"20%"})}),$(".agent-login-bg").find("#password").length&&($.validator.setDefaults({highlight:function(e){$(e).parent("div").addClass("has-error")},unhighlight:function(e){$(e).parent("div").removeClass("has-error")}}),$("#forget-password-form").validate({errorClass:"has-error",rules:{new_password:{required:!0},confirm_new_password:{required:!0}}})),$(".main-content").find("#transaction").length&&$(window).on("load",function(){var n,a;$("#daterange-btn").daterangepicker({ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},startDate:moment().subtract(29,"days"),endDate:moment()},function(e,t){n=moment(e,"MMMM D, YYYY").format("DD-MM-YYYY"),$("#startfrom").val(n),a=moment(t,"MMMM D, YYYY").format("DD-MM-YYYY"),$("#endto").val(a),$("#daterange-btn span").html(n+" - "+a)});var e=formDate,t=toDate;""==e?$("#daterange-btn span").html('<i class="fa fa-calendar"></i> '+pickDateRange):$("#daterange-btn span").html(e+" - "+t)}),$(".main-content").find("#addUser").length&&(hasEmailError=hasPhoneError=!1,pwd1=document.getElementById("password"),pwd2=document.getElementById("confirm_password"),pwd1.onchange=confirmPwd,pwd2.onkeyup=confirmPwd,$(document).ready(function(){$("#phone").intlTelInput({separateDialCode:!0,nationalMode:!0,preferredCountries:["us"],autoPlaceholder:"polite",placeholderNumberType:"MOBILE",utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/13.0.4/js/utils.js"});var e=$("#phone").intlTelInput("getSelectedCountryData");$("#defaultCountry").val(e.iso2),$("#carrierCode").val(e.dialCode),$("#phone").on("countrychange",function(e,t){formattedPhone(),$("#defaultCountry").val(t.iso2),$("#carrierCode").val(t.dialCode),""!==$.trim($(this).val())?$(this).intlTelInput("isValidNumber")||($("#tel-error").addClass("error").html("Please enter a valid International Phone Number.").css("font-weight"),hasPhoneError=!0,enableDisableButton(),$("#phone-error").hide()):($("#tel-error").html(""),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())})}),$(document).ready(function(){$("input[name=phone]").on("blur",function(e){formattedPhone();var t,n,a=document.getElementById("validatorPhoneError");a&&(a.innerHTML=""),""!==$.trim($(this).val())?$(this).intlTelInput("isValidNumber")?(t=$(this).val().replace(/-|\s/g,""),t=$(this).val().replace(/^0+/,""),a="+"+(n=$("#phone").intlTelInput("getSelectedCountryData").dialCode)+t,$.ajax({headers:{"X-CSRF-TOKEN":csrfToken},method:"POST",url:ajaxUrlPhoneCheck,dataType:"json",data:{phone:t,carrierCode:n,formattedPhone:a}}).done(function(e){0==e.status?0==t.length?$("#phone-error").html(""):($("#phone-error").addClass("error").html(e.message).css("font-weight"),hasPhoneError=!0,enableDisableButton()):1==e.status&&($("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())}),$("#tel-error").html(""),$("#phone-error").show(),hasPhoneError=!1,enableDisableButton()):($("#tel-error").addClass("error").html("Please enter a valid International Phone Number.").css("font-weight"),hasPhoneError=!0,enableDisableButton(),$("#phone-error").hide()):($("#tel-error").html(""),$("#phone-error").html(""),hasPhoneError=!1,enableDisableButton())})}),$(document).ready(function(){$("#email").on("input",function(e){var a=$("#email").val(),t=document.getElementById("validatorEmailError");t&&(t.innerHTML=""),$.ajax({headers:{"X-CSRF-TOKEN":csrfToken},method:"POST",url:ajaxUrlEmailCheck,dataType:"json",data:{email:a}}).done(function(e){function t(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function n(){0===a.length&&($("#email_error").html(""),$("#email_ok").html(""))}0==e.status?(n(),t(a)?($("#email_error").addClass("error").html(e.message).css("font-weight"),$("#email_ok").html(""),hasEmailError=!0,enableDisableButton()):$("#email_error").html("")):1==e.status&&(n(),(t(a)?$("#email_error"):$("#email_ok")).html(""),hasEmailError=!1,enableDisableButton())})})})),$(".main-content").find("#deleteUser").length&&$(document).on("click",".delete-warning",function(e){e.preventDefault();e=ajaxUrl;$("#delete-modal-yes").attr("href",e),$("#delete-warning-modal").modal("show")}),$(".main-content").find("#editUser").length&&(hasEmailError=hasPhoneError=!1,pwd1=document.getElementById("password"),pwd2=document.getElementById("confirm_password"),pwd1.onchange=confirmPwd,pwd2.onkeyup=confirmPwd,$(function(){$("#phone").intlTelInput({separateDialCode:!0,nationalMode:!0,preferredCountries:["us"],autoPlaceholder:"polite",placeholderNumberType:"MOBILE",formatOnDisplay:!1,utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/13.0.4/js/utils.js"}).done(function(){var e=formatted,t=userCarrierCode,n=defaultCountryCode;null!==e&&null!==t&&null!==n&&($("#phone").intlTelInput("setNumber",e),$("#user_defaultCountry").val(n),$("#user_carrierCode").val(t))})}),countryData=$("#phone").intlTelInput("getSelectedCountryData"),$("#user_defaultCountry").val(countryData.iso2),$("#user_carrierCode").val(countryData.dialCode),$("#phone").on("countrychange",function(e,t){$("#user_defaultCountry").val(t.iso2),$("#user_carrierCode").val(t.dialCode),formattedPhone();var n=$("#id").val();checkInvalidAndDuplicatePhoneNumberForUserProfile($.trim($(this).val()),$.trim(t.dialCode),n)}),$("#phone").on("blur",function(e){formattedPhone();var t=$("#id").val();$(this).val().replace(/-|\s/g,"");checkInvalidAndDuplicatePhoneNumberForUserProfile($(this).val().replace(/^0+/,""),$(this).intlTelInput("getSelectedCountryData").dialCode,t)}),$(document).ready(function(){$("#email").on("input",function(e){var n=$(this).val(),t=$("#id").val();$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:ajaxUrlEmailCheck,dataType:"json",data:{email:n,user_id:t}}).done(function(e){function t(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}0===n.length&&($("#emailError").html(""),$("#email-ok").html("")),1==e.status?t(n)?($("#emailError").addClass("error").html(e.fail).css("font-weight","bold"),$("#email-ok").html(""),hasEmailError=!0,enableDisableButton()):$("#emailError").html(""):0==e.status&&(hasEmailError=!1,enableDisableButton(),(t(n)?$("#emailError"):$("#email-ok")).html(""))})})})),$(".main-content").find("#withdrawal").length&&($(window).on("load",function(){$("#amount").val("")}),$("input[name=amount]").on("input",function(e){""==$(this).val()||isNaN($(this).val())||getPayoutFeesLimit()}),$(".select2user").select2({placeholder:userTxt,minimumInputLength:1,ajax:{method:"POST",url:searchUserkUrl,delay:500,processResults:function(e){return{results:e}}}}),$("#currencies").on("change",function(e){getPayoutFeesLimit()}),$(".select2user").on("select2:select",function(e){$("#currencies").empty(),$("#amount").val(""),$(".amountLimit").text(""),$("#withdrawMoney").attr("disabled",!1);var t=e.params.data.id,e=csrfToken;$.ajax({method:"POST",url:withdrawCurrencylistUrl,dataType:"json",data:{token:e,user_id:t}}).done(function(e){0!=e.currencyList.length?$.each(e.currencyList,function(e,t){t=new Option(t.code,t.id);$("#currencies").append(t)}):($("#noAvailableCurrency").html(currencyNotFoundTxt),$("#withdrawMoney").attr("disabled",!0))})})),$(".main-content").find("#withdrawalConfirm").length&&($(document).ready(function(){$('[data-toggle="tooltip"]').tooltip()}),$("input[name=payout_verify_code]").on("input",function(e){6==$(this).val().length&&payoutVerification()}),isNumberOrDecimalPointKey=function(e,t){t=t.which||t.keyCode;return 46==t?-1===e.value.indexOf("."):!(31<t&&(t<48||57<t))},$("button[type=submit]").click(function(){$(this).attr("disabled","disabled"),$(this).parents("form").submit()}),jQuery(function(e){startTimer(300,e("#time"))})),$(".main-content").find("#withdrawalSuccess").length&&($(document).ready(function(){window.history.pushState(null,"",window.location.href),window.onpopstate=function(){window.history.pushState(null,"",window.location.href)}}),$(document).ready(function(){$(document).bind("keydown",disable_f5)}),$(document).ready(function(){$(document).bind("keydown",disable_ctrl_r)}));